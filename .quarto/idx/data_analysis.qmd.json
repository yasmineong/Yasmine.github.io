{"title":"Data analysis","markdown":{"yaml":{"title":"Data analysis"},"headingText":"1. Lemon market: How are the prices of second-hand cars in India like?","containsRefs":false,"markdown":"\nHere is a summary of all the variables in the dataset.\n```{r, echo = F, warning = F, message = F}\nlibrary(tidyverse)\nnew_cars <- read.csv(\"used_cars_data.csv\")\ncars1 <- new_cars %>%\n  separate(Mileage, into = c(\"Mileage_v\", \"Mileage_unit\"), sep = \" \")\n\ncars2 <- cars1 %>%\n  separate(Name, into = c(\"Brand\", \"Model\"), sep = \" \", extra = \"merge\") %>%\n  mutate(Brand = case_when(\n    Brand == \"ISUZU\" ~ \"Isuzu\",\n    Brand == \"Land\" ~ \"Land Rover\",\n    TRUE ~ Brand\n  ))\n\ncars <- cars2 %>%\n  mutate(\"Engine/CC\" = as.numeric(str_remove(Engine, \"CC\")),\n         \"Power/bhp\" = as.numeric(str_remove(Power, \"bhp\")),\n         \"Mileage_value\" = as.numeric(Mileage_v), \n         \"Car_age\" =  year(Sys.Date()) - Year\n  ) %>%\n  select(-c(Power, Engine, Mileage_v)) \n\ncars <- cars %>%\n  select(Brand, Model, Location, Year, Car_age, Kilometers_Driven, Fuel_Type, Transmission, Owner_Type, Mileage_value, Mileage_unit, `Engine/CC`, `Power/bhp`, Seats, New_Price, Price)\nknitr::kable(head(summary(cars)))\n```\nLet's get started!\n\n\n```{r, echo = F, warning = F, message = F}\ncars %>%\n  filter(Owner_Type == c(\"First\", \"Second\")) %>%\n  mutate(Year = ym(str_c(Year, \"-01\"))) %>%\n  na.omit() %>%\n  group_by(Year, Owner_Type) %>%\n  summarise(Price = mean(Price, na.rm = T)) %>%\n  ggplot(aes(x = Year, y = Price)) +\n  geom_line() +\n  geom_point(colour = \"red\") +\n  facet_wrap(~ Owner_Type) +\n  labs(title = \"Overall prices of first and second hand cars in India against time\") +\n  theme_bw() \n```\n<div style=\"text-align: justify;\">\nThere has been an increase in second-hand car prices till around 2013 (though this may vary, eg. Bangladore and Delhi experienced increases earlier) but seems to be mostly coming down after that, leading to a growing difference in prices of first and second hand cars. If we were to do some predictions (predictive pricing models will not be covered here), the decreasing trend can provide a benchmark against which sellers' asking prices can be compared. If sellers consistently ask for prices significantly higher than the predicted values for similar cars, it may indicate that they are attempting to exploit buyers' lack of information or conceal defects in the vehicles. Thus knowing price trends can better protect consumers in the lemon market as it allows them to assess the risk associated with purchasing a used car through price signals.\n\nHowever, if the growing difference in prices is driven by increased uncertainty and risk associated with buying used cars, it may signal a market failure that requires intervention to improve transparency and consumer protection. This widening price gap could result from a worsening lemon market problem, where buyers become increasingly wary of purchasing used cars due to concerns about hidden defects or poor quality. Therefore, there is also a need to investigate the cause of this growing price difference.\n</div>\n\nNow let's see how these pricing trends may differ in different parts in India.\n<br>\n```{r, echo = F, warning = F, message = F}\nlibrary(lubridate)\nlibrary(stringr)\ncars %>%\n  filter(Owner_Type == \"Second\") %>%\n  mutate(Year = ym(str_c(Year, \"-01\"))) %>%\n  na.omit() %>%\n  group_by(Location, Year) %>%\n  summarise(Price = mean(Price, na.rm = T)) %>%\n  ggplot(aes(x = Year, y = Price)) +\n  geom_line(colour = \"blue\") +\n  labs(title = \"Prices of second hand cars in different parts of India against time\") +\n  facet_wrap(~ Location, nrow = 4, scales = \"free_y\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 60, size = 7, vjust = 0.5),\n        plot.title = element_text(family = \"Helvetica\"))\n```\n<div style=\"text-align: justify;\">\nIn Chennai, Delhi, and Jaipur, it's notable that price trends are still on the rise. Consumers in these areas should recognize that comparing prices of second-hand cars with those in other parts of India may not be valid. Additionally, they shouldn't be surprised if sellers continue to offer such (second-hand) models at even higher prices.\n</div>\n# 2. Carbon emissions? Average kilometers driven in India\n\nFor this graph, one outlier from Chennai was removed.\n```{r, echo = F, warning = F, message = F}\ncars %>%\n  filter(Kilometers_Driven <= 4e+06) %>%\n  mutate(Year = ym(str_c(Year, \"-01\"))) %>%\n  na.omit() %>%\n  group_by(Year, Location) %>%\n  summarise(Ave_km_driven = mean(Kilometers_Driven, na.rm = T)) %>%\n  ggplot(aes(x = Year, y = Ave_km_driven)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Graph of average kilometers driven in each part of India against time\",\n       x = \"Year\",\n       y = \"Average kilometers driven\")\n```\n<div style=\"text-align: justify;\">\nThere is a decrease in average kilometres driven over time and generally, since less distance is covered, there should be less gas emissions (though it still depends on a variety of factors). \n```{r, out.height= \"700px\",out.width= \"800px\",echo=F,eval=TRUE,fig.cap=\"Photo from *Our World in Data* on India's Carbon Emissions\"}\nknitr::include_graphics(\"india_emissions.png\")\n```\nIf we were to assume ave_km_driven ≈ carbon emissions, this means that cars are becoming smaller contributors to the increase in global emissions as shown in the image since they display opposite trends. Moreover, it does not seem that CO2 emissions from cars will double by 2050 which means the policies in place, and the measure implemented by the government seem to be working.\n\nNext, here's a shiny app to investigate this phenomenon more closely in different cities of India.\n</div>\n<br>\n```{=html}\n<iframe height=\"400\" width=\"100%\" frameborder=\"no\" src=\"https://cc01lz-yasmineong.shinyapps.io/MyShinyApp/\"> </iframe>\n```\n<div style=\"text-align: justify;\">\nIf you click through, you can see that there is all cities show a decrease in average kilometers driven throughout the years. But upon closer inspection, different cars brands contribute differently to the average distance travelled. Depending on the fuel efficiency on the brand, more can then be derived about the true emission level generated by each one of them, which can aid the government in deciding which firms to clamp down on for emission levels.\n</div>\n\n\n# 3. Preferences and car usage in India \n\nHere's bar graphs of the categorical variables of this dataset. \n```{r, echo = F, warning = F}\nlibrary(patchwork)\nplot1 <- cars %>%\n  ggplot(aes(x = Fuel_Type)) +\n  geom_bar(fill = \"#0AE1FB\") +\n  labs(title = \"Count of cars per fuel type\",\n       x = \"Fuel type\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\nplot2 <- cars %>%\n  ggplot(aes(x = Transmission)) +\n  geom_bar(fill = \"red\") +\n  labs(title = \"Count of cars per transmission type\",\n       x = \"Transmission type\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\nplot3 <- cars %>%\n  ggplot(aes(x = Owner_Type)) +\n  geom_bar(fill = \"#0AFBBD\") +\n  labs(title = \"Count of cars per owner type\",\n       x = \"Owner type\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\nplot4 <- cars %>%\n  ggplot(aes(x = Brand)) +\n  geom_bar(fill = \"#FAA4E8\") +\n  labs(title = \"Count of cars per brand\",\n       x = \"Brands\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8),\n         axis.text.x = element_text(angle = 45, size = 5, vjust = 0.5)) \n\nplot5 <- cars %>%\n  count(Model) %>%\n  arrange(desc(n)) %>%\n  head(10) %>%\n  ggplot(aes(x = Model, y = n)) +\n  geom_col(fill = \"Black\") +\n  labs(title = \"Count of cars per (top 10) model\",\n       x = \"Models\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8),\n         axis.text.x = element_text(angle = 45, size = 7, vjust = 0.5)) \n\nplot6 <- cars %>%\n  ggplot(aes(x = Location)) +\n  geom_bar(fill = \"#F5B041\") +\n  labs(title = \"Count of cars per location\",\n       x = \"Location\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8),\n         axis.text.x = element_text(angle = 45, size = 7, vjust = 0.5)) \n\nplot1 + plot2 + plot3 + plot4 + plot5 + plot6 + plot_layout(ncol = 2) \n```\nNow, let's zoom into car brands:\n```{r, echo = F}\nlibrary(patchwork)\nmarket_share <- cars %>%\n  group_by(Brand) %>%\n  summarise(count = n()) %>%\n  mutate(market_share = count / sum(count) * 100) %>%\n  arrange(desc(market_share)) %>%\n  head(10)\npie(market_share$market_share, \n    labels = paste(market_share$Brand, \": \", round(market_share$market_share, 2), \"%\"), \n    main = \"Market Share Analysis by Car Brand (Top 10)\",\n    col = c(\"#004BF8\", \"#0080F8\", \"#00A9F8\", \"#02CEF7\", \"#02E8F7\", \"#A3F7FF\", \"#A3AEFF\", \"#C489FF\", \"#B603FF\", \"#6C03BE\"),\n    font = 3,\n    cex = 0.8)\n```\n<div style=\"text-align: justify;\"> Maruti seems to be the most popular car brand that Indian consumers go for, seeing how it has the highest count of cars owned by Indians in all the regions (in the dataset). Let's take a closer look into why this may be so by looking at price:\n</div>\n```{r, echo = F, message = F, warning = F}\ncars_summary <- cars %>%\n  group_by(Brand) %>%\n  summarise(Count = n()) %>%\n  arrange(desc(Count))\n\ntop_10_brands <- cars_summary %>%\n  head(10) %>%\n  pull(Brand)\n\ncars$Top_10 <- ifelse(cars$Brand %in% top_10_brands, \"Top 10\", \"Others\")\n\nggplot(cars, aes(x = Price, y = Brand)) +\n  geom_boxplot(colour = \"#00A6FF\") +\n  facet_wrap(~ Top_10, scales = \"free_y\") +\n  labs(title = \"Price Ranges for Each Car Brand\", \n       x = \"Price\", \n       y = \"Brand\",\n      ) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) \n```\n<div style=\"text-align: justify;\">\nUpon closer examination of the prices of individual car brands, a preference for the most economical option, Maruti, is evident among the top 10. Meanwhile, brands such as Audi, BMW, and Mercedes-Benz, which command higher average prices, consequently hold a smaller market share as fewer consumers opt for them. However, their inclusion in the top 10 may suggest a significant demand among Indian consumers for luxury car brands.\n\nNext, what about do the numerical variables of this dataset tell us?\n</div>\n```{r, echo = F, warning = F, message = F}\nlibrary(patchwork)\ngraph1 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Price, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Price\",\n       x = \"Price\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph2 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Car_age, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Car Age \",\n       x = \"Car age\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph3 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Kilometers_Driven, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Kilometers Driven\",\n       x = \"Kilometers driven\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph4 <- cars %>%\n  filter(Mileage_unit == \"kmpl\") %>%\n  na.omit() %>%\n  ggplot(aes(x = Mileage_value, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Mileage Values\",\n       x = \"Mileage\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph5 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = `Engine/CC`, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Engine Values\",\n       x = \"Engine/CC\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph6 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = `Power/bhp`, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Power Values\",\n       x = \"Power/bhp\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph7 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Seats, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Number of Seats\",\n       x = \"Seats\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph1 + graph2 + graph3 + graph4 + graph5 + graph6 + graph7 + plot_layout(ncol = 2)\n```\n\n1. Preferences for low costs, 5-seater vehicles, lower power and engine vehicles.\n2. Automatic cars seem to have higher power and engine than manual cars --> More may opt for manual cars since they are of lower power and engine.\n3. Cars in India do not travel very long distances.\n4. Most of the histograms are highly skewed, which may lead to some poor performances of certain models.\n\n# 4. Predictors in the market\n\n```{r, echo = F}\nlibrary(ggcorrplot)\nnumerical_variables <- cars %>%\n  na.omit() %>%\n  select(Price, Car_age, Kilometers_Driven, Mileage_value, `Engine/CC`, `Power/bhp`, Seats) \n\nggcorrplot(cor(numerical_variables),\n           hc.order = TRUE,  \n           lab = TRUE,\n           lab_size = 2,\n           outline.color = \"black\",  \n           colors = c(\"blue\", \"white\", \"red\"),  \n           title = \"Correlation Heatmap of Numerical variables\")\n\n```\n\n1. Strongest correlation between the power and engine capacity of a car.\n\n2. There is a strong correlation between costs and power of the car --> the higher the BHP, the higher the costs of the car which matches what vehicle analytics say. However, since customers in India tend to go for lower prices, producers need not create so many high-powered cars. Moreover, India's cities are known for their traffic congestion thus smaller, less powerful engines are practical for navigating these conditions efficient.\n\n3. Relationship of price and engine of a car is also moderately strong. This seems to be in line with India's taxation policies: they impose higher taxes on cars with larger engines and as a result higher BHP, making such vehicles much more unafforable.\n\n**Citations**: \n<br> https://www.cars24.com/blog/what-is-bhp-in-cars/\n<br> Ritchie, H., Roser, M., & Rosado, P. (2020, May 11). *India: CO2 Country Profile*. Our World in Data. [https://ourworldindata.org/co2/country/india#what-are-the-country-s-annual-co2-emissions](https://ourworldindata.org/co2/country/india#what-are-the-country-s-annual-co2-emissions) ","srcMarkdownNoYaml":"\nHere is a summary of all the variables in the dataset.\n```{r, echo = F, warning = F, message = F}\nlibrary(tidyverse)\nnew_cars <- read.csv(\"used_cars_data.csv\")\ncars1 <- new_cars %>%\n  separate(Mileage, into = c(\"Mileage_v\", \"Mileage_unit\"), sep = \" \")\n\ncars2 <- cars1 %>%\n  separate(Name, into = c(\"Brand\", \"Model\"), sep = \" \", extra = \"merge\") %>%\n  mutate(Brand = case_when(\n    Brand == \"ISUZU\" ~ \"Isuzu\",\n    Brand == \"Land\" ~ \"Land Rover\",\n    TRUE ~ Brand\n  ))\n\ncars <- cars2 %>%\n  mutate(\"Engine/CC\" = as.numeric(str_remove(Engine, \"CC\")),\n         \"Power/bhp\" = as.numeric(str_remove(Power, \"bhp\")),\n         \"Mileage_value\" = as.numeric(Mileage_v), \n         \"Car_age\" =  year(Sys.Date()) - Year\n  ) %>%\n  select(-c(Power, Engine, Mileage_v)) \n\ncars <- cars %>%\n  select(Brand, Model, Location, Year, Car_age, Kilometers_Driven, Fuel_Type, Transmission, Owner_Type, Mileage_value, Mileage_unit, `Engine/CC`, `Power/bhp`, Seats, New_Price, Price)\nknitr::kable(head(summary(cars)))\n```\nLet's get started!\n\n# 1. Lemon market: How are the prices of second-hand cars in India like?\n\n```{r, echo = F, warning = F, message = F}\ncars %>%\n  filter(Owner_Type == c(\"First\", \"Second\")) %>%\n  mutate(Year = ym(str_c(Year, \"-01\"))) %>%\n  na.omit() %>%\n  group_by(Year, Owner_Type) %>%\n  summarise(Price = mean(Price, na.rm = T)) %>%\n  ggplot(aes(x = Year, y = Price)) +\n  geom_line() +\n  geom_point(colour = \"red\") +\n  facet_wrap(~ Owner_Type) +\n  labs(title = \"Overall prices of first and second hand cars in India against time\") +\n  theme_bw() \n```\n<div style=\"text-align: justify;\">\nThere has been an increase in second-hand car prices till around 2013 (though this may vary, eg. Bangladore and Delhi experienced increases earlier) but seems to be mostly coming down after that, leading to a growing difference in prices of first and second hand cars. If we were to do some predictions (predictive pricing models will not be covered here), the decreasing trend can provide a benchmark against which sellers' asking prices can be compared. If sellers consistently ask for prices significantly higher than the predicted values for similar cars, it may indicate that they are attempting to exploit buyers' lack of information or conceal defects in the vehicles. Thus knowing price trends can better protect consumers in the lemon market as it allows them to assess the risk associated with purchasing a used car through price signals.\n\nHowever, if the growing difference in prices is driven by increased uncertainty and risk associated with buying used cars, it may signal a market failure that requires intervention to improve transparency and consumer protection. This widening price gap could result from a worsening lemon market problem, where buyers become increasingly wary of purchasing used cars due to concerns about hidden defects or poor quality. Therefore, there is also a need to investigate the cause of this growing price difference.\n</div>\n\nNow let's see how these pricing trends may differ in different parts in India.\n<br>\n```{r, echo = F, warning = F, message = F}\nlibrary(lubridate)\nlibrary(stringr)\ncars %>%\n  filter(Owner_Type == \"Second\") %>%\n  mutate(Year = ym(str_c(Year, \"-01\"))) %>%\n  na.omit() %>%\n  group_by(Location, Year) %>%\n  summarise(Price = mean(Price, na.rm = T)) %>%\n  ggplot(aes(x = Year, y = Price)) +\n  geom_line(colour = \"blue\") +\n  labs(title = \"Prices of second hand cars in different parts of India against time\") +\n  facet_wrap(~ Location, nrow = 4, scales = \"free_y\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 60, size = 7, vjust = 0.5),\n        plot.title = element_text(family = \"Helvetica\"))\n```\n<div style=\"text-align: justify;\">\nIn Chennai, Delhi, and Jaipur, it's notable that price trends are still on the rise. Consumers in these areas should recognize that comparing prices of second-hand cars with those in other parts of India may not be valid. Additionally, they shouldn't be surprised if sellers continue to offer such (second-hand) models at even higher prices.\n</div>\n# 2. Carbon emissions? Average kilometers driven in India\n\nFor this graph, one outlier from Chennai was removed.\n```{r, echo = F, warning = F, message = F}\ncars %>%\n  filter(Kilometers_Driven <= 4e+06) %>%\n  mutate(Year = ym(str_c(Year, \"-01\"))) %>%\n  na.omit() %>%\n  group_by(Year, Location) %>%\n  summarise(Ave_km_driven = mean(Kilometers_Driven, na.rm = T)) %>%\n  ggplot(aes(x = Year, y = Ave_km_driven)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Graph of average kilometers driven in each part of India against time\",\n       x = \"Year\",\n       y = \"Average kilometers driven\")\n```\n<div style=\"text-align: justify;\">\nThere is a decrease in average kilometres driven over time and generally, since less distance is covered, there should be less gas emissions (though it still depends on a variety of factors). \n```{r, out.height= \"700px\",out.width= \"800px\",echo=F,eval=TRUE,fig.cap=\"Photo from *Our World in Data* on India's Carbon Emissions\"}\nknitr::include_graphics(\"india_emissions.png\")\n```\nIf we were to assume ave_km_driven ≈ carbon emissions, this means that cars are becoming smaller contributors to the increase in global emissions as shown in the image since they display opposite trends. Moreover, it does not seem that CO2 emissions from cars will double by 2050 which means the policies in place, and the measure implemented by the government seem to be working.\n\nNext, here's a shiny app to investigate this phenomenon more closely in different cities of India.\n</div>\n<br>\n```{=html}\n<iframe height=\"400\" width=\"100%\" frameborder=\"no\" src=\"https://cc01lz-yasmineong.shinyapps.io/MyShinyApp/\"> </iframe>\n```\n<div style=\"text-align: justify;\">\nIf you click through, you can see that there is all cities show a decrease in average kilometers driven throughout the years. But upon closer inspection, different cars brands contribute differently to the average distance travelled. Depending on the fuel efficiency on the brand, more can then be derived about the true emission level generated by each one of them, which can aid the government in deciding which firms to clamp down on for emission levels.\n</div>\n\n\n# 3. Preferences and car usage in India \n\nHere's bar graphs of the categorical variables of this dataset. \n```{r, echo = F, warning = F}\nlibrary(patchwork)\nplot1 <- cars %>%\n  ggplot(aes(x = Fuel_Type)) +\n  geom_bar(fill = \"#0AE1FB\") +\n  labs(title = \"Count of cars per fuel type\",\n       x = \"Fuel type\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\nplot2 <- cars %>%\n  ggplot(aes(x = Transmission)) +\n  geom_bar(fill = \"red\") +\n  labs(title = \"Count of cars per transmission type\",\n       x = \"Transmission type\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\nplot3 <- cars %>%\n  ggplot(aes(x = Owner_Type)) +\n  geom_bar(fill = \"#0AFBBD\") +\n  labs(title = \"Count of cars per owner type\",\n       x = \"Owner type\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\nplot4 <- cars %>%\n  ggplot(aes(x = Brand)) +\n  geom_bar(fill = \"#FAA4E8\") +\n  labs(title = \"Count of cars per brand\",\n       x = \"Brands\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8),\n         axis.text.x = element_text(angle = 45, size = 5, vjust = 0.5)) \n\nplot5 <- cars %>%\n  count(Model) %>%\n  arrange(desc(n)) %>%\n  head(10) %>%\n  ggplot(aes(x = Model, y = n)) +\n  geom_col(fill = \"Black\") +\n  labs(title = \"Count of cars per (top 10) model\",\n       x = \"Models\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8),\n         axis.text.x = element_text(angle = 45, size = 7, vjust = 0.5)) \n\nplot6 <- cars %>%\n  ggplot(aes(x = Location)) +\n  geom_bar(fill = \"#F5B041\") +\n  labs(title = \"Count of cars per location\",\n       x = \"Location\",\n       y = \"Count\") +\n  theme_light() +\n   theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8),\n         axis.text.x = element_text(angle = 45, size = 7, vjust = 0.5)) \n\nplot1 + plot2 + plot3 + plot4 + plot5 + plot6 + plot_layout(ncol = 2) \n```\nNow, let's zoom into car brands:\n```{r, echo = F}\nlibrary(patchwork)\nmarket_share <- cars %>%\n  group_by(Brand) %>%\n  summarise(count = n()) %>%\n  mutate(market_share = count / sum(count) * 100) %>%\n  arrange(desc(market_share)) %>%\n  head(10)\npie(market_share$market_share, \n    labels = paste(market_share$Brand, \": \", round(market_share$market_share, 2), \"%\"), \n    main = \"Market Share Analysis by Car Brand (Top 10)\",\n    col = c(\"#004BF8\", \"#0080F8\", \"#00A9F8\", \"#02CEF7\", \"#02E8F7\", \"#A3F7FF\", \"#A3AEFF\", \"#C489FF\", \"#B603FF\", \"#6C03BE\"),\n    font = 3,\n    cex = 0.8)\n```\n<div style=\"text-align: justify;\"> Maruti seems to be the most popular car brand that Indian consumers go for, seeing how it has the highest count of cars owned by Indians in all the regions (in the dataset). Let's take a closer look into why this may be so by looking at price:\n</div>\n```{r, echo = F, message = F, warning = F}\ncars_summary <- cars %>%\n  group_by(Brand) %>%\n  summarise(Count = n()) %>%\n  arrange(desc(Count))\n\ntop_10_brands <- cars_summary %>%\n  head(10) %>%\n  pull(Brand)\n\ncars$Top_10 <- ifelse(cars$Brand %in% top_10_brands, \"Top 10\", \"Others\")\n\nggplot(cars, aes(x = Price, y = Brand)) +\n  geom_boxplot(colour = \"#00A6FF\") +\n  facet_wrap(~ Top_10, scales = \"free_y\") +\n  labs(title = \"Price Ranges for Each Car Brand\", \n       x = \"Price\", \n       y = \"Brand\",\n      ) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) \n```\n<div style=\"text-align: justify;\">\nUpon closer examination of the prices of individual car brands, a preference for the most economical option, Maruti, is evident among the top 10. Meanwhile, brands such as Audi, BMW, and Mercedes-Benz, which command higher average prices, consequently hold a smaller market share as fewer consumers opt for them. However, their inclusion in the top 10 may suggest a significant demand among Indian consumers for luxury car brands.\n\nNext, what about do the numerical variables of this dataset tell us?\n</div>\n```{r, echo = F, warning = F, message = F}\nlibrary(patchwork)\ngraph1 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Price, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Price\",\n       x = \"Price\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph2 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Car_age, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Car Age \",\n       x = \"Car age\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph3 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Kilometers_Driven, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Kilometers Driven\",\n       x = \"Kilometers driven\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph4 <- cars %>%\n  filter(Mileage_unit == \"kmpl\") %>%\n  na.omit() %>%\n  ggplot(aes(x = Mileage_value, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Mileage Values\",\n       x = \"Mileage\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph5 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = `Engine/CC`, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Engine Values\",\n       x = \"Engine/CC\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph6 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = `Power/bhp`, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Power Values\",\n       x = \"Power/bhp\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph7 <- cars %>%\n  na.omit() %>%\n  ggplot(aes(x = Seats, fill = Transmission)) +\n  geom_density(adjust = 0.5) +\n  labs(title = \"Density Plot of Number of Seats\",\n       x = \"Seats\",\n       y = \"Density\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 10),\n         axis.title.x = element_text(size = 8),\n         axis.title.y = element_text(size = 8)) \n\ngraph1 + graph2 + graph3 + graph4 + graph5 + graph6 + graph7 + plot_layout(ncol = 2)\n```\n\n1. Preferences for low costs, 5-seater vehicles, lower power and engine vehicles.\n2. Automatic cars seem to have higher power and engine than manual cars --> More may opt for manual cars since they are of lower power and engine.\n3. Cars in India do not travel very long distances.\n4. Most of the histograms are highly skewed, which may lead to some poor performances of certain models.\n\n# 4. Predictors in the market\n\n```{r, echo = F}\nlibrary(ggcorrplot)\nnumerical_variables <- cars %>%\n  na.omit() %>%\n  select(Price, Car_age, Kilometers_Driven, Mileage_value, `Engine/CC`, `Power/bhp`, Seats) \n\nggcorrplot(cor(numerical_variables),\n           hc.order = TRUE,  \n           lab = TRUE,\n           lab_size = 2,\n           outline.color = \"black\",  \n           colors = c(\"blue\", \"white\", \"red\"),  \n           title = \"Correlation Heatmap of Numerical variables\")\n\n```\n\n1. Strongest correlation between the power and engine capacity of a car.\n\n2. There is a strong correlation between costs and power of the car --> the higher the BHP, the higher the costs of the car which matches what vehicle analytics say. However, since customers in India tend to go for lower prices, producers need not create so many high-powered cars. Moreover, India's cities are known for their traffic congestion thus smaller, less powerful engines are practical for navigating these conditions efficient.\n\n3. Relationship of price and engine of a car is also moderately strong. This seems to be in line with India's taxation policies: they impose higher taxes on cars with larger engines and as a result higher BHP, making such vehicles much more unafforable.\n\n**Citations**: \n<br> https://www.cars24.com/blog/what-is-bhp-in-cars/\n<br> Ritchie, H., Roser, M., & Rosado, P. (2020, May 11). *India: CO2 Country Profile*. Our World in Data. [https://ourworldindata.org/co2/country/india#what-are-the-country-s-annual-co2-emissions](https://ourworldindata.org/co2/country/india#what-are-the-country-s-annual-co2-emissions) "},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"data_analysis.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title":"Data analysis"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}